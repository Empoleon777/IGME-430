(()=>{"use strict";var e,t,n,c,r,o={d:(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},a={};o.r(a),o.d(a,{audioData:()=>p,circleList:()=>w,ctx:()=>m,draw:()=>_,j:()=>k,movingCircle:()=>H,setJIndex:()=>X,setupCanvas:()=>U});var i,s,u,l,h,d,m,g,f,v,p,y,w,k,b,S,T=Object.freeze({gain:.5,numSamples:256}),q=(new Uint8Array(T.numSamples/2),!1),x=!1,A=!1,B=!1,R=!1,C=!1,F=20,V=function(e){t.src=e},M=function(t){(q=t.checked)?(i.frequency.setValueAtTime(1e3,e.currentTime),i.gain.setValueAtTime(25,e.currentTime)):i.gain.setValueAtTime(0,e.currentTime)},z=function(t){(x=t.checked)?(s.frequency.setValueAtTime(1e3,e.currentTime),s.gain.setValueAtTime(15,e.currentTime)):s.gain.setValueAtTime(0,e.currentTime)},P=function(t){(A=t.checked)?(u.frequency.setValueAtTime(1e3,e.currentTime),u.gain.setValueAtTime(15,e.currentTime)):u.gain.setValueAtTime(0,e.currentTime)},L=function(t){(B=t.checked)?(l.frequency.setValueAtTime(1e3,e.currentTime),l.gain.setValueAtTime(15,e.currentTime)):l.gain.setValueAtTime(0,e.currentTime)},I=function(t){(R=t.checked)?(h.frequency.setValueAtTime(1e3,e.currentTime),h.gain.setValueAtTime(15,e.currentTime)):h.gain.setValueAtTime(0,e.currentTime)},O=function(e){(C=e.checked)?(d.curve=null,d.curve=j(F)):d.curve=null},j=function(e){void 0===e&&(e=20);for(var t=new Float32Array(256),n=0;n<256;++n){var c=2*n/256-1;t[n]=(Math.PI+e)*c/(Math.PI+e*Math.abs(c))}return t},D=function(e){void 0===e&&(e=35);var t=function(){return t=e,n=255-e,Math.random()*(n-t)+t;var t,n};return"rgba(".concat(t(),",").concat(t(),",").concat(t(),",1)")};k=0,b=0;var W,N,E,G,H=function(){function e(e,t,n){this.ctx=e,this.radius=1,this.random=t,this.x=-5,this.y=Math.random()*f,this.speed=n,this.color,this.changeRandom(t)}return e.prototype.draw=function(){this.ctx.save(),this.ctx.beginPath(),this.ctx.fillStyle=this.color,this.ctx.arc(this.x,this.y,this.radius,0,2*Math.PI,!1),this.ctx.fill(),this.ctx.closePath(),this.ctx.restore()},e.prototype.move=function(e){this.ctx.save(),this.x+=this.speed*e/1e3,this.ctx.restore()},e.prototype.reset=function(e){this.x=0,this.y=Math.random()*f,this.speed=e},e.prototype.changeRandom=function(e){var t;this.random=e,1==this.random?this.color=D():this.color=(255,255,void 0===t&&(t=1),"rgba(".concat(255,",").concat(255,",").concat(255,",").concat(t,")"))},e}(),J=function(e,t,n){var c=this;this.draw=function(e){c.ctx.save(),c.ctx.beginPath(),c.ctx.lineWidth=1,c.ctx.strokeStyle=c.color,c.ctx.arc(c.x,c.y,c.radius,0,2*Math.PI,!1),c.ctx.stroke(),c.ctx.closePath(),c.ctx.restore()},this.expand=function(e){c.ctx.save(),c.radius+=c.growthRate*e/1e5,c.ctx.restore()},this.reset=function(){c.radius=0},this.ctx=e,this.x=g/2,this.y=f/2,this.radius=0,this.growthRate=t,this.color=n},U=function(e,t){m=e.getContext("2d"),g=e.width,f=e.height,function(e,t,n,c,r,o){for(var a=e.createLinearGradient(0,0,0,r),i=0,s=[{percent:0,color:"blue"},{percent:.25,color:"green"},{percent:.5,color:"yellow"},{percent:.75,color:"red"},{percent:1,color:"magenta"}];i<s.length;i++){var u=s[i];a.addColorStop(u.percent,u.color)}}(m,0,0,0,f),v=t,p=new Uint8Array(v.fftSize/2),y=new Uint8Array(v.fftSize/2),w=[],S=new J(m,0,"white")},_=function(e,t){if(v.getByteFrequencyData(p),v.getByteTimeDomainData(y),m.save(),m.fillStyle="black",m.globalAlpha=.5,m.fillRect(0,0,g,f),m.restore(),e.showBackgroundCircles&&1==G)for(var n=0;n<w.length;n++)w[n].speed=p[n],0==w[n].speed&&(w[n].speed=10),w[n].move(t),w[n].draw(),w[n].x>=g&&(w[n].reset(p[k]),(++k>=p.length||0==p[k])&&(k=0));if(e.showBars){var c=(g-2*(i=5))/p.length,r=void 0,o=100;for(m.save(),n=0;n<p.length;n++)m.fillStyle="rgba(".concat(p[n],",0,").concat(255-p[n],",1)"),m.strokeStyle="rgba(255,255,255,0.2)",r=p[n]+100,m.fillRect(i+n*c,f+10,c/10,(-r-10)/2),m.strokeRect(i+n*c,f+10,c/10,(-r-10)/2);m.restore()}if(e.showWave){var a=g/y.length,i=(o=100,5);for(m.save(),m.strokeStyle="rgba(255,255,255,1)",m.lineWidth=2,m.beginPath(),m.moveTo(0,o+256-f/2),n=0;n<y.length;n++)m.lineTo(n*a+i,o+256-y[n]/128*(f/2));m.stroke(),m.restore()}if(e.showCircles&&1==G){for(m.save(),m.globalAlpha=.5,n=0;n<p.length;n++)p[n],b<=0?(0==S.growthRate&&(S.growthRate=2*p[n]),S.draw(e),S.expand(t),S.radius>g/2*1.5&&(S.growthRate=0,S.reset(),b=.25)):b-=t/1e3;m.restore()}var s=m.getImageData(0,0,g,f),u=s.data,l=u.length,h=s.width;for(n=0;n<l;n+=4)if(e.showInvert){var d=u[n],T=u[n+1],q=u[n+2];u[n]=255-d,u[n+1]=255-T,u[n+2]=255-q}if(e.showEmboss)for(n=0;n<l;n++)n%4!=3&&(u[n]=127+2*u[n]-u[n+4]-u[n+4*h]);m.putImageData(s,0,0)},X=function(e){k=e},K=a,Q={showBars:!0,showWave:!1,showCircles:!0,showOgerpon:!0,showInvert:!1,showEmboss:!1,showBackgroundCircles:!0,randomizeBackgroundCircles:!0},Y=Object.freeze({sound1:"media/New Adventure Theme.mp3"}),Z=function(t){document.querySelector("#fs-button").onclick=function(e){var n;console.log("goFullscreen() called"),(n=t).requestFullscreen?n.requestFullscreen():n.mozRequestFullscreen?n.mozRequestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen&&n.webkitRequestFullscreen()};var n=document.querySelector("#track-select");$(n);var c=document.querySelector("audio");n.onchange=function(e){var t=e.target;V(t.value),c.src=n.value},c.src="media/New Adventure Theme.mp3",c.onplay=function(t){"suspended"==e.state&&e.resume(),G=!0},c.onpause=function(e){G=!1};var r=document.querySelectorAll('input[name="display-type"]'),o=document.querySelector("#circles-cb"),a=document.querySelector("#ogerpon-cb"),i=document.querySelector("#invert-cb"),s=document.querySelector("#emboss-cb"),u=document.querySelector("#b-circles-cb"),l=document.querySelector("#randomize-cb"),h=document.querySelector("#circles-input");r[0].onclick=function(e){var t=e.target;Q.showBars=t.checked,1==Q.showWave?Q.showWave=!1:Q.showWave=!0},r[1].onclick=function(e){var t=e.target;Q.showWave=t.checked,1==Q.showBars?Q.showBars=!1:Q.showBars=!0},o.onclick=function(e){var t=e.target;Q.showCircles=t.checked},a.onclick=function(e){var t=e.target;Q.showOgerpon=t.checked},i.onclick=function(e){var t=e.target;Q.showInvert=t.checked},s.onclick=function(e){var t=e.target;Q.showEmboss=t.checked},u.onclick=function(e){var t=e.target;Q.showBackgroundCircles=t.checked;for(var n=0;n<K.circleList.length;n++)K.circleList[n].reset(K.audioData[n]);K.setJIndex(0)},l.onclick=function(e){var t=e.target;Q.randomizeBackgroundCircles=t.checked;for(var n=0;n<K.circleList.length;n++)K.circleList[n].changeRandom(Q.randomizeBackgroundCircles)},h.onchange=function(e){for(var t=e.target,n=0;n<K.circleList.length;n++)K.circleList[n].radius=Number(t.value)};var d=document.querySelector("#cb-highshelf");d.checked=q,d.onchange=function(e){M(d)},M(d);var m=document.querySelector("#cb-lowshelf");m.checked=x,m.onchange=function(e){z(m)},z(m);var g=document.querySelector("#cb-allpass");g.checked=A,g.onchange=function(e){P(g)},P(g);var f=document.querySelector("#cb-bandpass");f.checked=B,f.onchange=function(e){L(f)},L(f);var v=document.querySelector("#cb-peaking");v.checked=R,v.onchange=function(e){I(v)},I(v);var p=document.querySelector("#slider-distortion"),y=document.querySelector("#cb-distortion");p.value=F.toString(),p.onchange=function(e){var t,n=e.target;t=Number(n.value),F=t,O(y)},y.checked=C,y.onchange=function(e){O(y)}},$=function(e){var t=new XMLHttpRequest;t.onload=function(t){var n=t.target,c=n.responseText;console.log("Success - The file length is ".concat(c.length));var r=JSON.parse(n.responseText);document.querySelector("title").innerHTML=r.title,r.songs&&Array.isArray(r.songs)&&(e.innerHTML="".concat(r.songs.map((function(e){return'<option value="'.concat(e.value,'">').concat(e.name,"</option>")})).join("")),e.value="media/New Adventure Theme.mp3");for(var o=0;o<r.parameters.length;o++)Q[o]=r.parameters[o]},t.onerror=function(e){console.log("An error occurred.")},t.open("GET","data/av-data.json"),t.send()},ee=function(){setTimeout(ee,1e3/60),N=performance.now(),E=N-W,K.draw(Q,E),W=N};window.onload=function(){console.log("window.onload called"),function(){var o,a;o=Y.sound1,a=window.AudioContext,e=new a,t=document.querySelector("audio"),V(o),n=e.createMediaElementSource(t),(c=e.createAnalyser()).fftSize=T.numSamples,(r=e.createGain()).gain.value=T.gain,n.connect(c),c.connect(r),r.connect(e.destination),(i=e.createBiquadFilter()).type="highshelf",n.connect(i),i.connect(c),(s=e.createBiquadFilter()).type="lowshelf",n.connect(s),s.connect(c),(u=e.createBiquadFilter()).type="allpass",n.connect(u),u.connect(c),(l=e.createBiquadFilter()).type="bandpass",n.connect(l),l.connect(c),(h=e.createBiquadFilter()).type="peaking",n.connect(h),h.connect(c),d=e.createWaveShaper(),n.connect(d),d.connect(c),console.log("init called"),console.log("Testing utils.getRandomColor() import: ".concat(D()));var m=document.querySelector("canvas");Z(m),K.setupCanvas(m,c);for(var g=0;g<K.audioData.length;g++)K.circleList.push(new K.movingCircle(K.ctx,Q.showBackgroundCircles,K.audioData[g]));W=performance.now(),ee()}()}})();
//# sourceMappingURL=bundle.js.map